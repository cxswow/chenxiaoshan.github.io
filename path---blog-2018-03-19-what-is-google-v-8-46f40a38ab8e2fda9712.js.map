{"version":3,"sources":["webpack:///path---blog-2018-03-19-what-is-google-v-8-46f40a38ab8e2fda9712.js","webpack:///./.cache/json/blog-2018-03-19-what-is-google-v-8.json"],"names":["webpackJsonp","355","module","exports","data","markdownRemark","html","fields","tagSlugs","frontmatter","title","tags","date","pathContext","slug"],"mappings":"AAAAA,cAAc,iBAERC,IACA,SAAUC,EAAQC,GCHxBD,EAAAC,SAAkBC,MAAQC,gBAAkBC,KAAA,+kuBAA4+qBC,QAAk+DC,UAAA,mBAA8BC,aAAgBC,MAAA,gBAAAC,MAAA,MAAAC,KAAA,gBAA4DC,aAAgBC,KAAA","file":"path---blog-2018-03-19-what-is-google-v-8-46f40a38ab8e2fda9712.js","sourcesContent":["webpackJsonp([210764608676883],{\n\n/***/ 355:\n/***/ (function(module, exports) {\n\n\tmodule.exports = {\"data\":{\"markdownRemark\":{\"html\":\"<h1>前言</h1>\\n<p>由 C/C++ 入门的我突然转 JS (主要是 Node.js) 感觉整个人都是懵逼的（还不是懂得太少造的o-O），差别真的感觉好大，最神奇的是 JS 竟然不用经过编译就可以运行。\\n期间总是能遇到 Google V8，不明觉厉，感觉有必要好好了解下，顺便好好梳理下基础知识。</p>\\n<h1>静态编译与动态解释</h1>\\n<p>众所周知，计算机只能理解机器语言，而我们平时编程用的通常是高级语言，所以源代码通常都要经过层层转换最终变成机器语言运行。</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/1-f3b2d800f4a83e7b4546fd00ad7d8fc2-c15ab.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 680px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 43.97058823529412%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABS0lEQVQoz41R7U6DQBDk/d/GF9B/RhPTWFONKPJZCtfCFTi+ORhvLz1ME390k+M2w84ww1rLsqBtW4zjCKp5nvWhGobhCqdZKsK6rtPvDWZuiwY552iaZiVKKXUvhEBdC90TZj5EBvI8R1VVq5ARtQzZiE2TxCSVy785EGdUuFSglPOVyKT4pLE6pIaskxu6h75FLThEkSJLv3AI3lHmEdqmRF2dFHlC3/frPPHN0YL0KMsSURSpCAI8ixD+bHCMtgjsB2yf78CCFyR7G7H/imnsUBTFZb5ao5pj4Z9aLjHN76CYt5QWpGWEYYjz+azBTkUreYIi85H4G3j2EzizURUMhYo+jb1aVI0sy+D7vnaapumfQ8YYPM9DHMdqKQsKfkAc7HA6fGDvPOJ7d49T/IZj4oLtP9WGhRJg2oTruprrOM4a37opCnBz5F+K47maL83/pgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #ffffff;\\\"\\n        alt=\\\"汇编器与编译器概念图\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/1-f3b2d800f4a83e7b4546fd00ad7d8fc2-c15ab.png\\\"\\n        srcset=\\\"/static/1-f3b2d800f4a83e7b4546fd00ad7d8fc2-441fe.png 197w,\\n/static/1-f3b2d800f4a83e7b4546fd00ad7d8fc2-f40a6.png 393w,\\n/static/1-f3b2d800f4a83e7b4546fd00ad7d8fc2-c15ab.png 680w\\\"\\n        sizes=\\\"(max-width: 680px) 100vw, 680px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>早期只有汇编语言没有高级语言，不同的设备有一套自己的对应不同机器语言指令集的汇编语言，也就是说，汇编语言不能在不同系统平台之间移植。同一个软件为了让不同类型的设备都能用要写好几套代码，实在太不方便了，所以后来发展出了跨平台的高级语言。</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/2-63c82b2afb6d7aaa6544daec47a3b450-3dca0.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 500px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 53.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABiklEQVQoz5VS207CQBTs//+BX2HUEC8BjE9yewABxdLSUtrSbu8tV2k7HhYRVFA5yeQ0293Z2TMjpGmGLNshTVNsK89znFoC058wVuuwhg2YSp2+Gwh8hjTL14yc9BRiwVYfYfRL0F5LGPaKMKUy9JEEzRyT4vSDMNtD/qn+OzjhdBJgNg0w5wgxSbz1dljMwWq1OqjimOL1uhB5OkJXReRp1IcIHBXpagnH8/G2XCCgNc+W4Voy74tZxA/PZzFCOht4BnUDi/lko9CUHzDoFKB0ryG3C9B6N/TkPlrPPbQ6TYzle4jNS9xenGHQvoI56kJSdYgvFYylIlrVcxjiHXymbAhDd61MIWUK7z4b0O0JDMtGksQImEz/JHhWH74lIoloFJSMJPYQ+yNEvk4YccWcMA5dxKFNYLSZIfRtGkYG23HI6Wwzm+2M/nCYz5BplY2zYpmcLvInakMRqm5wlzlNvsNXZ3+6L1haE5Zao/zVYA6qlMUq4sg9Go392BzMIb94X/Y/4vFbvQM7dE0e/2P72wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #ffffff;\\\"\\n        alt=\\\"高级语言未出现时\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/2-63c82b2afb6d7aaa6544daec47a3b450-3dca0.png\\\"\\n        srcset=\\\"/static/2-63c82b2afb6d7aaa6544daec47a3b450-07d85.png 197w,\\n/static/2-63c82b2afb6d7aaa6544daec47a3b450-b3775.png 393w,\\n/static/2-63c82b2afb6d7aaa6544daec47a3b450-3dca0.png 500w\\\"\\n        sizes=\\\"(max-width: 500px) 100vw, 500px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/3-07f97969c0aeab6af26737e6daeb5f54-c51f6.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 499px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 19.839679358717433%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsSAAALEgHS3X78AAAA3ElEQVQY01WQW0+DQBCF+///jokPpiaSJo01Gi88SCiK5VLKRQiXtpTd5XOhKY3nYc/uzJmzMzNDQymFEJ1mOTJ9zwVSyuk96Pp/OTWmznyOz4ajKiLizSO+syT8WpBnAadOkmYJsf+Kbd5jvtzhWgZ5+kO9b0ljV9c849ordpqbKrsalnnIr78kcBbErkEUrsmKEtuxSbwV1tstH083eNacXfCJFyVsvt/ZOg+szTmhY+imtldD0Z1o6oLjodI/FSgpprEO+4r2WNO1jb6Xo3YaWYhxHVLrh3UM+AOXqi92V3ZYuQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #ffffff;\\\"\\n        alt=\\\"高级语言出现后\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/3-07f97969c0aeab6af26737e6daeb5f54-c51f6.png\\\"\\n        srcset=\\\"/static/3-07f97969c0aeab6af26737e6daeb5f54-47974.png 197w,\\n/static/3-07f97969c0aeab6af26737e6daeb5f54-46ae9.png 393w,\\n/static/3-07f97969c0aeab6af26737e6daeb5f54-c51f6.png 499w\\\"\\n        sizes=\\\"(max-width: 499px) 100vw, 499px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>随着计算机发展，编译器也越来越复杂，发展了很多分支，像是本地编译器、交叉编译器等，这里就不多说了。</p>\\n<p>那么源码一定要经过编译才能运行吗？</p>\\n<p><strong>解释器</strong>的出现给出了一种不用编译就能运行的能力，也就是我一开始说的让我很不习惯的地方。</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/4-303413cf27d6b664be4fb5328c9e264e-6e769.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 566px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 43.109540636042404%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABPElEQVQoz51S206DQBDl/7/DxD8wWo0PGvXFR7W2EqSUFkoXFhY0XBaOM0ugeEuMk5zM7E7O7JmZtUDWdR0G3zRND60P8R/REt/iIqYgQbetSfC5pfgb+H7M6U85TQIYFiY2XP5m4+M/5mC6suTeRRp7yJLNqIJNpSHiyIXYuZBiDd3UIzmL14iDJyS7hYGg+K1IiU8tB/Y5/OUFIvcG/naLMIrw4jjw7SvcXx/j9vII3vMMvu9gHyewXQ+efQd/cQZ3PoPzcIrXxxPkaUBiACsVK1K3NgrrujYz5LaV3JISD4py3EFVvhv1WrekeIUknENGS4N4qnA6BzNcwn+MHzMzPAy63/KwlK7rC1dVBSEEwjCElBJZlhFS45kz8IdNW9PNsa+//K2yLKGUQkYoigI5I8+hCNO/yjwu+gGT4bk82Kqu5QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #ffffff;\\\"\\n        alt=\\\"解释器\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/4-303413cf27d6b664be4fb5328c9e264e-6e769.png\\\"\\n        srcset=\\\"/static/4-303413cf27d6b664be4fb5328c9e264e-5f1fe.png 197w,\\n/static/4-303413cf27d6b664be4fb5328c9e264e-93c7e.png 393w,\\n/static/4-303413cf27d6b664be4fb5328c9e264e-6e769.png 566w\\\"\\n        sizes=\\\"(max-width: 566px) 100vw, 566px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>前面说的都算是先静态编译到可执行的文件，然后运行可执行的文件来执行程序，而解释器提供了一种边编译边运行的动态运行方法，而也正因为通过解释器运行的代码是边编译边运行的，所以运行的速度比静态编译的那种慢很多。</p>\\n<p>所以程序运行的方式分为<strong>静态编译</strong>和<strong>动态解释</strong>。</p>\\n<p>我从 C/C++ 跨到 JS 里，就是从静态编译跨到了动态解释里。</p>\\n<h1>即时编译与虚拟机</h1>\\n<p>这小节的概念了解 Java 的人应该很了解，虽然我之前接触过一点 Java 但是直到现在才算是摸清了点真面目，当然学习的过程我也没对 Java 做过多深入，毕竟主旨是 Google V8 呀！</p>\\n<p><strong>即时编译</strong>（Just-in-time compilation）混合了编译器和解释器，在边编译边运行的过程中会将编译过的代码缓存起来，下次运行的时候运行的就是编译后的代码。</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/5-db454a55ac66c9a8d80d2e903fcba027-0a76b.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 700px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 31.857142857142858%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABCklEQVQY05VR2WrDMBD0//9PHktJKRRaQtsUeqUhTRQpcmLZkWTLji17qiMGv3Zh0O6wGmlnk2EYMAw9/Gn7Hp21sLZD113hchu4yI8YeX9vGsm06J3gf2Lsj5/ycIKmFCiOK6icwNQ1jDGQgiClXwHFaYOmaaBVDsE/HD6RsffA+34pHc/ekNGXwCVSbEF/5uC7Z5ylxElkYL8LLJ9meH2cga4foJTEMSU4rOfYr+5Avm/BtwuclQbne/DNveNvwMkSydSBqR/N5YLCPdA6H33uobVCWeoryjhRbSAyhlwcYNs6ejgKxSXY4E3btqCUYUcIeJqCMuYmUKicJWVVBSitQ23qi1to1PgDdBnNCzRltwYAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #ffffff;\\\"\\n        alt=\\\"即时编译示意图\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/5-db454a55ac66c9a8d80d2e903fcba027-0a76b.png\\\"\\n        srcset=\\\"/static/5-db454a55ac66c9a8d80d2e903fcba027-56d76.png 197w,\\n/static/5-db454a55ac66c9a8d80d2e903fcba027-24e50.png 393w,\\n/static/5-db454a55ac66c9a8d80d2e903fcba027-0a76b.png 700w\\\"\\n        sizes=\\\"(max-width: 700px) 100vw, 700px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>当然，虽然即时编译在运行过一次以后有了编译后的代码，再次运行时因为识别编译过的和未编译过的（即修改）代码，速度还是比静态编译的程序运行的慢。</p>\\n<p>避免二次编译也使得理论上即时编译的总体开销（编译和运行）优于静态编译和动态解释。</p>\\n<p>这里还出现了一个<strong>字节码</strong>的概念。</p>\\n<p>字节码的出现理由有点像<strong>交叉编译器</strong>（在 A 系统平台下可以产生 B 系统平台的可执行文件的编译器），在源码不能或很难编译成目标平台可执行文件时非常好用。感觉也有点像是跨平台的汇编语言，复杂度介于高级语言和低级语言之间。</p>\\n<p>在即时编译里出现的字节码是一种动态字节码转译方式，字节码也可以静态转译的，就是先编译成字节码再运行的。</p>\\n<p>字节码通常运行在一个程序<strong>虚拟机</strong>上。</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/6-f6aab7265b5859b112485bcf43d1fe00-0a76b.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 700px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 35.857142857142854%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAABFUlEQVQoz4VR2W6DMBDk/z+qUg+lL31pq7RVRAMIGkGwwfjiNNN1QhL1IelKI+85HnsD3LB5ngl0YsES/6mffIJzDoHVHJJHMIrDGgXBIlRFiNY26PoRWlWQVYKGJ7DWQEsGTnXBErRdByVLiHJLPRnGcUQgWIwsfALbR2AsRxo+Y/v5AFHtIJRBWSTIvleHfF0zsCJC9PWIXfwC0QiUeUjzKxTpG6aJCJ2boYy59XJSMqIbJvxn0zQR4exQC3GQ3/X9EYuvtEZT/SBLPpDFaxi5P//dVULv2LY9DGtSeoKxFryukaevCNf32LzfgeebM6FfgKE+S31ewDAMR8Jrt102efEdBX7Ikw20AKkUFEGTGE/s879n7B2MWs6vQQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #ffffff;\\\"\\n        alt=\\\"字节码与虚拟机\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/6-f6aab7265b5859b112485bcf43d1fe00-0a76b.png\\\"\\n        srcset=\\\"/static/6-f6aab7265b5859b112485bcf43d1fe00-56d76.png 197w,\\n/static/6-f6aab7265b5859b112485bcf43d1fe00-24e50.png 393w,\\n/static/6-f6aab7265b5859b112485bcf43d1fe00-0a76b.png 700w\\\"\\n        sizes=\\\"(max-width: 700px) 100vw, 700px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>图里的虚拟机部分也算是一个解释执行的过程。</p>\\n<p>广义的虚拟机包括一切跟任何真实机器无关的虚拟架构。\\n而当前虚拟机的实现主要分成三类：</p>\\n<ul>\\n<li>\\n<p><strong>系统虚拟机</strong>：虚拟了一个运行完整系统的操作平台。典型代表：VirtualBox。</p>\\n</li>\\n<li>\\n<p><strong>程序虚拟机</strong>：为单个计算机程序的运行虚拟必要的环境。典型代表：Java 虚拟机。</p>\\n</li>\\n<li>\\n<p><strong>操作系统层虚拟化</strong>：介于系统和单个程序之间，可以运行多个独立应用程序，但是又不用虚拟完整操作系统。典型代表：Docker。</p>\\n</li>\\n</ul>\\n<h1>Google V8</h1>\\n<p>终于来到了 Google V8！</p>\\n<blockquote>\\n<p><strong>V8</strong> 是 Google 开发的开源的 JavaScript 引擎，用于 Google Chrome 及 Chromium 中。</p>\\n</blockquote>\\n<blockquote>\\n<p><strong>JavaScript 引擎</strong>是一个专门处理 JavaScript 脚本的虚拟机，一般会附带在网页浏览器之中。</p>\\n</blockquote>\\n<p>V8 是用 C++ 写的，使用了即时编译技术，工作模式如下图：\\n\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/7-e725f6630e8fb14f65dfb9a6cd9a9a5b-0a76b.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 700px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 72.14285714285715%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAACWklEQVQ4y31TW2vUQBTef+L/UfBv+NBX/4KKKGLBBxGKb1pU6AqFrrW0aL3UYleqXXuhe3GvSZpNssnM5DbJ55kkm2yLeODkcs7MN9/5zpkaCjNMG87MRRxH8xCEEOj8XsXgfAthGuHg2xp2PrwHj2wgSXDj8W2s7W1na2UikaYpap7n4nvzEPdXv+DJiwZcxy4BHWuEg8Z17O0sZ//tbgsr9XVcWAbCKMTNO0tYXwBUVlOP3f1DLD2q497zDTo4T9BhmDkW2uctTKd2Fph6PpqnbTgeRxAEmPR68BwHUs73pDngUdfAw9VPePp2H9wPc3oEGEcxnQxEUZQHSs/lmJFErusV+QIwIS2Uff3Zxo/jXlnuSJug26/+HZejpTlwGUNSMHKEgUCKEqwsWRIocx1w0lMZD31s1zdQX3mJoT7OYvWtJq7d3cRyYxcRy9cZkxN400kJWJasPiTVVmpB/vndR2y92oTFdbBgAs1wsHv8B6YvMWM6TLuL4Ncp/KMTSFGxrM2pzk2Bpogx7Bk4aw1pkUQUxqRnCEFVWKZJoxVn69iFCabpSBY1LJHSSgfOJMIghIwlOBfggmVx3w+ycVEWU25q25knxb5LgGmaN0c3+3j2+has2RgitOGJMXVeh+WNiBUxJWnmjUzpnfn/AMdaB28aD9DqdaDRAJ+OBzgaKEAdzbM+9lr9crQWgS41pQKt9DzuXRBLAYv5MGZM3TSaN5KC9CoZFiCLVrsKppgq55yTM/iCZ+66LpjngdEcLjJTpgZb5dWw/5Ph1VOvWp6u2KmOq6uogP8CWxsq0aOLzukAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #ffffff;\\\"\\n        alt=\\\"V8 工作模式图-来自[1]\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/7-e725f6630e8fb14f65dfb9a6cd9a9a5b-0a76b.png\\\"\\n        srcset=\\\"/static/7-e725f6630e8fb14f65dfb9a6cd9a9a5b-56d76.png 197w,\\n/static/7-e725f6630e8fb14f65dfb9a6cd9a9a5b-24e50.png 393w,\\n/static/7-e725f6630e8fb14f65dfb9a6cd9a9a5b-0a76b.png 700w\\\"\\n        sizes=\\\"(max-width: 700px) 100vw, 700px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>感觉到这里已经足够说明什么是 Google V8 了，后面算是拓展阅读吧。</p>\\n<h3>V8 的隐藏类（Hidden Class）</h3>\\n<p>JavaScript 作为一种动态编程语言，对象上的属性（Property）可以随时增减。如果用字典类的数据结构来存储这些对象属性，访问的时候就会带来动态查找的损耗，这也是 JavaScript 比类似 Java 这种类型确定的语言慢的原因之一。</p>\\n<p>V8 用动态创建隐藏类的方式来减少这种损耗。</p>\\n<p>举个例子。</p>\\n<p>有如下简单的一段 JS 代码：</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token keyword\\\">function</span> <span class=\\\"token function\\\">Point</span><span class=\\\"token punctuation\\\">(</span>x<span class=\\\"token punctuation\\\">,</span> y<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>x <span class=\\\"token operator\\\">=</span> x<span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">// E1</span>\\n  <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>y <span class=\\\"token operator\\\">=</span> y<span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">// E2</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Point</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">//  E0</span>\\n</code></pre>\\n      </div>\\n<p>语句按 E0、E1、E2 的顺序执行。</p>\\n<p>执行 E0 的时候，创建一个隐藏类 C0，对象的类指示器指向 C0。</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/8-dd1945631d2519b9b24166ffad948b41-42aa8.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 436px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 41.055045871559635%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABMElEQVQoz51S2W7CMBDk/78IiQdQKX1Ii6BIVAmhFAo57VwkIYlzTDeOgnrASy2N1/bujke7OwCtpmnwczXXt+++v3G/ssg/6IOEEIgjjiQO0ee1vlvI8wtEkaEsc2m7ey5zBu2WZyk8Y4HEfUZkKfCd7V0VVVWCHefYvY2hLkf43Exh7R7BzLUUIgl9R4e5ncD+eCLMYGwf4Psu0kuGJE0IqURMsGwLzkHBXp1Aex3hpE/h7GdwjivUPWHgaNBXQ6znQxl0UMcwjD2Y58PljMDp7MF2GdSNCp/bpLRAKTIUxYWQgbsm6rruCM8hQ2gqEMECufcCbizJebsBVVkgCjmpaYhQUB0FxVbyk9Zem9KSckuDZ79TkbM7TelqGAVckvYIA4b4HHRNae6Mw3/H5gsr+GioV5jVfgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #ffffff;\\\"\\n        alt=\\\"E0 阶段\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/8-dd1945631d2519b9b24166ffad948b41-42aa8.png\\\"\\n        srcset=\\\"/static/8-dd1945631d2519b9b24166ffad948b41-b9f8d.png 197w,\\n/static/8-dd1945631d2519b9b24166ffad948b41-e754c.png 393w,\\n/static/8-dd1945631d2519b9b24166ffad948b41-42aa8.png 436w\\\"\\n        sizes=\\\"(max-width: 436px) 100vw, 436px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>执行 E1 的时候，在 C0 基础上新建一个隐藏类 C1（C1 知道 x 属性存的位置），并给 C0 增加一个转换指示：如果增加一个 x 属性，就变成 C1。</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/9-3ba61291a82cff51302228ff51a15346-8b302.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 426px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 62.676056338028175%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAAB/ElEQVQ4y4WTaXPaMBCG+f8/pd+att+YSafTDBMoNw3hMBhblm8b4QMfmDeSTB3C0MnOrFeyvY/2UgtcqgrI8wzlqRJbnM/nxl6vawucqrO0wq/ia7mvv6KVHRM4ZApP78HRh4gOPupDqgb4rkDo6XCNKczdBLbwo3+5/wQstKVfS8BSt4diP0UeDOBoXZRlif9JYM1hrdvo/vqCl/4DyKINT32Ebys10N49Y9L9gT9PXzHofIO2+InNdgliWtANAzqlUg3TxHA2w2o5BvNV7L1amb+DY7zCd8glQn0AZj6DWX0crB5stYMoYryeJxRF8a486iRN4Ht1ap4fglIb7JDwjE5ge68GRsyHy+sXOwMERheBq12SO99N2Xcp9qHLwRZc28A+cODxd6F/qaF45FnGi+oiTWJ8JhWP/FQWiOMI/fGIN4pnwidENFEC/41DE4GjwtJGMLYjkO1QdlM0ztJn/OBj858ogajttQhWq5m3ywkeneFgPvEOfses9wDttY1A/42AdJDErHHOixwab9rtvLau6UKovoS66kPbjGGRFzh0AZfrat6FslnXXecgRVWhEfI50DIJd1SxWm+lDQIG1wuhKGsc0/jDv7fru0DH0kGNnQSvlnMo6wUMwvd0B3GrriO6vZZ3gSWvzTGNZDR5lkrNjrGE3QPcyhuQveJ7h0xKMwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #ffffff;\\\"\\n        alt=\\\"E1 阶段\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/9-3ba61291a82cff51302228ff51a15346-8b302.png\\\"\\n        srcset=\\\"/static/9-3ba61291a82cff51302228ff51a15346-7c7da.png 197w,\\n/static/9-3ba61291a82cff51302228ff51a15346-4c801.png 393w,\\n/static/9-3ba61291a82cff51302228ff51a15346-8b302.png 426w\\\"\\n        sizes=\\\"(max-width: 426px) 100vw, 426px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>执行 E2 的时候，在 C1 基础上新建一个隐藏类 C2（C2 知道 x 和 y 属性存位置），并给 C1 增加一个转换指示：如果增加一个 y 属性，就变成 C2。</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/10-6e6628d1689c9913d336f32a4b5f7c72-ac902.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 558px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 79.39068100358423%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAACBklEQVQ4y41TaY+bMBDl//+efmgrVT2yUtW0Uo/d7bJJCae5A5gjAQfyOnY22YQuakZ68tjA482bsQaK/R7ouhZ93+Ow31+Fvh/UOgzPuSbJeGqiir6DR3cQ3QbXRL/rELs/YDzcwFvNETlfUZcJtO2Gg/35CFv/AEd/h8j7jXrTom5qQjOBDRhzEVpzmPoMvvmF8s/gGYPWbisEqxv4xiew5XuE3gOKskLOCwJ/QnFAUZzOme9BCKHIs6wgywSapoQm5Ve5jzK+BU8W5IW4qmTRbVEWa3iuDcc2wSmvyvxAqDwhY/dP+cl45ZVAFhuIfV2pz6IlitRWTRSELEvheg560ZHiTjbl8PE50TE/KgnIjuWv11j8fIPYmiF25vSjnXreUdlplp2Ua1NkJ0LRouQpurZBmoTYNBWKPEEQBspTFgQnQjU2Ux49E3ao6xItmV5VFc0cUFeccq7UbVuaX3l4TjhWdq5QemhbK5imiSSOybOc9sY/zTu+r40PxjHQ7QmYhShk0PV76qqFOPSw24kXrbpQ2FRrFGuPwFDmAcG/uDm2572o6jwuCNfBLVz9Le6/vVK3Zu3MUGS+Gp9h6BFSyeMpGJNeEAbMhLG4A3MN8DyCay9gkV8JdVGSxWk6OV4ThA7MlYHHR12t8gbI6f9fmZOEsqMK1MEdjYvMZanjzp/n4/gLm8TWw8yhSsIAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #ffffff;\\\"\\n        alt=\\\"E2 阶段\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/10-6e6628d1689c9913d336f32a4b5f7c72-ac902.png\\\"\\n        srcset=\\\"/static/10-6e6628d1689c9913d336f32a4b5f7c72-35a8d.png 197w,\\n/static/10-6e6628d1689c9913d336f32a4b5f7c72-01661.png 393w,\\n/static/10-6e6628d1689c9913d336f32a4b5f7c72-ac902.png 558w\\\"\\n        sizes=\\\"(max-width: 558px) 100vw, 558px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>隐藏类的创建过程就是隐藏类树的创建过程，在之后遇到新建对象实例，就会先试图从已创建的树里找到对应的类，没找到的话才会新建对应的树节点。</p>\\n<p>这之后，每个对象的类指示器都指向对应的隐藏类，和 Java 里的类与对象关系差不多，JavaScript 在访问属性的时候就避免了相对漫长的查找，从而加快了速度。</p>\\n<p>从这里也可以得出一个优化代码的方式：尽量用相同的顺序实例化对象属性以最大化复用隐藏类树。</p>\\n<h3>GC（垃圾回收）</h3>\\n<p>V8 将内存分成：</p>\\n<ul>\\n<li><strong>new-space</strong>：对象刚创建的时候分配这里的内存给对象。内存小，GC 删除的一般是这里的数据。</li>\\n<li><strong>old-data-space</strong>：new-space 里的一些对象经过一轮 GC 没被删除，并且这些对象内部不包含指针（纯数据），就会被移到这里。</li>\\n<li><strong>old-pointer-space</strong>：new-space 里的一些对象经过一轮 GC 没被删除，并且这些对象内部包含指针（指向别的对象），就会被移到这里。</li>\\n<li><strong>large-object-space</strong>：大小超过别的 space 大小限制的对象会被放在这里，它们有专门非配的内存，不归 GC 管。</li>\\n<li><strong>code-space</strong>：代码对象（包含即时编译后的指令）存放的地方。会被执行的代码不是放在这里就是放在 large-object-space 里。</li>\\n<li><strong>cell-space，property-cell-space，map-space</strong>：分别存放对应名字（cells、propertyCells、maps）的地方（这里我也不太懂这啥）。</li>\\n</ul>\\n<p>GC 首先做的是分清数据对象和指针，因为跟踪指针才能知道哪些对象是不能被回收的。</p>\\n<p>V8 的 GC 有以下几个特点：</p>\\n<ul>\\n<li>运行 GC 的时候停止执行程序。</li>\\n<li>绝大多数的 GC 只处理部分数据对象内存垃圾以最小化对应用程序的影响。</li>\\n<li>总是正确地知道所有的对象和指针的存储位置。这避免了将对象误认为指针导致的内存泄漏。</li>\\n</ul>\\n<p>GC 我也没多看，也说不出个所以然来了，更多可以看<a href=\\\"http://www.jayconrod.com/posts/55/a-tour-of-v8-garbage-collection\\\">A tour of V8: Garbage Collection</a>。</p>\\n<p><strong>参考</strong>：</p>\\n<p><a href=\\\"https://medium.com/reloading/javascript-start-up-performance-69200f43b201\\\">图[1]来源</a></p>\\n<p>维基百科上的各种词条</p>\\n<p><a href=\\\"https://github.com/v8/v8/wiki/Design-Elements\\\">Design Elements</a></p>\\n<p><a href=\\\"http://www.jayconrod.com/posts/55/a-tour-of-v8-garbage-collection\\\">A tour of V8: Garbage Collection</a></p>\",\"fields\":{\"tagSlugs\":[\"/blog/tags/js/\"]},\"frontmatter\":{\"title\":\"什么是 Google V8\",\"tags\":[\"js\"],\"date\":\"2018-03-19\"}}},\"pathContext\":{\"slug\":\"/blog/2018-03-19-what-is-google-v-8\"}}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// path---blog-2018-03-19-what-is-google-v-8-46f40a38ab8e2fda9712.js","module.exports = {\"data\":{\"markdownRemark\":{\"html\":\"<h1>前言</h1>\\n<p>由 C/C++ 入门的我突然转 JS (主要是 Node.js) 感觉整个人都是懵逼的（还不是懂得太少造的o-O），差别真的感觉好大，最神奇的是 JS 竟然不用经过编译就可以运行。\\n期间总是能遇到 Google V8，不明觉厉，感觉有必要好好了解下，顺便好好梳理下基础知识。</p>\\n<h1>静态编译与动态解释</h1>\\n<p>众所周知，计算机只能理解机器语言，而我们平时编程用的通常是高级语言，所以源代码通常都要经过层层转换最终变成机器语言运行。</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/1-f3b2d800f4a83e7b4546fd00ad7d8fc2-c15ab.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 680px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 43.97058823529412%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABS0lEQVQoz41R7U6DQBDk/d/GF9B/RhPTWFONKPJZCtfCFTi+ORhvLz1ME390k+M2w84ww1rLsqBtW4zjCKp5nvWhGobhCqdZKsK6rtPvDWZuiwY552iaZiVKKXUvhEBdC90TZj5EBvI8R1VVq5ARtQzZiE2TxCSVy785EGdUuFSglPOVyKT4pLE6pIaskxu6h75FLThEkSJLv3AI3lHmEdqmRF2dFHlC3/frPPHN0YL0KMsSURSpCAI8ixD+bHCMtgjsB2yf78CCFyR7G7H/imnsUBTFZb5ao5pj4Z9aLjHN76CYt5QWpGWEYYjz+azBTkUreYIi85H4G3j2EzizURUMhYo+jb1aVI0sy+D7vnaapumfQ8YYPM9DHMdqKQsKfkAc7HA6fGDvPOJ7d49T/IZj4oLtP9WGhRJg2oTruprrOM4a37opCnBz5F+K47maL83/pgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #ffffff;\\\"\\n        alt=\\\"汇编器与编译器概念图\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/1-f3b2d800f4a83e7b4546fd00ad7d8fc2-c15ab.png\\\"\\n        srcset=\\\"/static/1-f3b2d800f4a83e7b4546fd00ad7d8fc2-441fe.png 197w,\\n/static/1-f3b2d800f4a83e7b4546fd00ad7d8fc2-f40a6.png 393w,\\n/static/1-f3b2d800f4a83e7b4546fd00ad7d8fc2-c15ab.png 680w\\\"\\n        sizes=\\\"(max-width: 680px) 100vw, 680px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>早期只有汇编语言没有高级语言，不同的设备有一套自己的对应不同机器语言指令集的汇编语言，也就是说，汇编语言不能在不同系统平台之间移植。同一个软件为了让不同类型的设备都能用要写好几套代码，实在太不方便了，所以后来发展出了跨平台的高级语言。</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/2-63c82b2afb6d7aaa6544daec47a3b450-3dca0.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 500px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 53.6%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABiklEQVQoz5VS207CQBTs//+BX2HUEC8BjE9yewABxdLSUtrSbu8tV2k7HhYRVFA5yeQ0293Z2TMjpGmGLNshTVNsK89znFoC058wVuuwhg2YSp2+Gwh8hjTL14yc9BRiwVYfYfRL0F5LGPaKMKUy9JEEzRyT4vSDMNtD/qn+OzjhdBJgNg0w5wgxSbz1dljMwWq1OqjimOL1uhB5OkJXReRp1IcIHBXpagnH8/G2XCCgNc+W4Voy74tZxA/PZzFCOht4BnUDi/lko9CUHzDoFKB0ryG3C9B6N/TkPlrPPbQ6TYzle4jNS9xenGHQvoI56kJSdYgvFYylIlrVcxjiHXymbAhDd61MIWUK7z4b0O0JDMtGksQImEz/JHhWH74lIoloFJSMJPYQ+yNEvk4YccWcMA5dxKFNYLSZIfRtGkYG23HI6Wwzm+2M/nCYz5BplY2zYpmcLvInakMRqm5wlzlNvsNXZ3+6L1haE5Zao/zVYA6qlMUq4sg9Go392BzMIb94X/Y/4vFbvQM7dE0e/2P72wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #ffffff;\\\"\\n        alt=\\\"高级语言未出现时\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/2-63c82b2afb6d7aaa6544daec47a3b450-3dca0.png\\\"\\n        srcset=\\\"/static/2-63c82b2afb6d7aaa6544daec47a3b450-07d85.png 197w,\\n/static/2-63c82b2afb6d7aaa6544daec47a3b450-b3775.png 393w,\\n/static/2-63c82b2afb6d7aaa6544daec47a3b450-3dca0.png 500w\\\"\\n        sizes=\\\"(max-width: 500px) 100vw, 500px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/3-07f97969c0aeab6af26737e6daeb5f54-c51f6.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 499px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 19.839679358717433%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsSAAALEgHS3X78AAAA3ElEQVQY01WQW0+DQBCF+///jokPpiaSJo01Gi88SCiK5VLKRQiXtpTd5XOhKY3nYc/uzJmzMzNDQymFEJ1mOTJ9zwVSyuk96Pp/OTWmznyOz4ajKiLizSO+syT8WpBnAadOkmYJsf+Kbd5jvtzhWgZ5+kO9b0ljV9c849ordpqbKrsalnnIr78kcBbErkEUrsmKEtuxSbwV1tstH083eNacXfCJFyVsvt/ZOg+szTmhY+imtldD0Z1o6oLjodI/FSgpprEO+4r2WNO1jb6Xo3YaWYhxHVLrh3UM+AOXqi92V3ZYuQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #ffffff;\\\"\\n        alt=\\\"高级语言出现后\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/3-07f97969c0aeab6af26737e6daeb5f54-c51f6.png\\\"\\n        srcset=\\\"/static/3-07f97969c0aeab6af26737e6daeb5f54-47974.png 197w,\\n/static/3-07f97969c0aeab6af26737e6daeb5f54-46ae9.png 393w,\\n/static/3-07f97969c0aeab6af26737e6daeb5f54-c51f6.png 499w\\\"\\n        sizes=\\\"(max-width: 499px) 100vw, 499px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>随着计算机发展，编译器也越来越复杂，发展了很多分支，像是本地编译器、交叉编译器等，这里就不多说了。</p>\\n<p>那么源码一定要经过编译才能运行吗？</p>\\n<p><strong>解释器</strong>的出现给出了一种不用编译就能运行的能力，也就是我一开始说的让我很不习惯的地方。</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/4-303413cf27d6b664be4fb5328c9e264e-6e769.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 566px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 43.109540636042404%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABPElEQVQoz51S206DQBDl/7/DxD8wWo0PGvXFR7W2EqSUFkoXFhY0XBaOM0ugeEuMk5zM7E7O7JmZtUDWdR0G3zRND60P8R/REt/iIqYgQbetSfC5pfgb+H7M6U85TQIYFiY2XP5m4+M/5mC6suTeRRp7yJLNqIJNpSHiyIXYuZBiDd3UIzmL14iDJyS7hYGg+K1IiU8tB/Y5/OUFIvcG/naLMIrw4jjw7SvcXx/j9vII3vMMvu9gHyewXQ+efQd/cQZ3PoPzcIrXxxPkaUBiACsVK1K3NgrrujYz5LaV3JISD4py3EFVvhv1WrekeIUknENGS4N4qnA6BzNcwn+MHzMzPAy63/KwlK7rC1dVBSEEwjCElBJZlhFS45kz8IdNW9PNsa+//K2yLKGUQkYoigI5I8+hCNO/yjwu+gGT4bk82Kqu5QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #ffffff;\\\"\\n        alt=\\\"解释器\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/4-303413cf27d6b664be4fb5328c9e264e-6e769.png\\\"\\n        srcset=\\\"/static/4-303413cf27d6b664be4fb5328c9e264e-5f1fe.png 197w,\\n/static/4-303413cf27d6b664be4fb5328c9e264e-93c7e.png 393w,\\n/static/4-303413cf27d6b664be4fb5328c9e264e-6e769.png 566w\\\"\\n        sizes=\\\"(max-width: 566px) 100vw, 566px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>前面说的都算是先静态编译到可执行的文件，然后运行可执行的文件来执行程序，而解释器提供了一种边编译边运行的动态运行方法，而也正因为通过解释器运行的代码是边编译边运行的，所以运行的速度比静态编译的那种慢很多。</p>\\n<p>所以程序运行的方式分为<strong>静态编译</strong>和<strong>动态解释</strong>。</p>\\n<p>我从 C/C++ 跨到 JS 里，就是从静态编译跨到了动态解释里。</p>\\n<h1>即时编译与虚拟机</h1>\\n<p>这小节的概念了解 Java 的人应该很了解，虽然我之前接触过一点 Java 但是直到现在才算是摸清了点真面目，当然学习的过程我也没对 Java 做过多深入，毕竟主旨是 Google V8 呀！</p>\\n<p><strong>即时编译</strong>（Just-in-time compilation）混合了编译器和解释器，在边编译边运行的过程中会将编译过的代码缓存起来，下次运行的时候运行的就是编译后的代码。</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/5-db454a55ac66c9a8d80d2e903fcba027-0a76b.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 700px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 31.857142857142858%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABCklEQVQY05VR2WrDMBD0//9PHktJKRRaQtsUeqUhTRQpcmLZkWTLji17qiMGv3Zh0O6wGmlnk2EYMAw9/Gn7Hp21sLZD113hchu4yI8YeX9vGsm06J3gf2Lsj5/ycIKmFCiOK6icwNQ1jDGQgiClXwHFaYOmaaBVDsE/HD6RsffA+34pHc/ekNGXwCVSbEF/5uC7Z5ylxElkYL8LLJ9meH2cga4foJTEMSU4rOfYr+5Avm/BtwuclQbne/DNveNvwMkSydSBqR/N5YLCPdA6H33uobVCWeoryjhRbSAyhlwcYNs6ejgKxSXY4E3btqCUYUcIeJqCMuYmUKicJWVVBSitQ23qi1to1PgDdBnNCzRltwYAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #ffffff;\\\"\\n        alt=\\\"即时编译示意图\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/5-db454a55ac66c9a8d80d2e903fcba027-0a76b.png\\\"\\n        srcset=\\\"/static/5-db454a55ac66c9a8d80d2e903fcba027-56d76.png 197w,\\n/static/5-db454a55ac66c9a8d80d2e903fcba027-24e50.png 393w,\\n/static/5-db454a55ac66c9a8d80d2e903fcba027-0a76b.png 700w\\\"\\n        sizes=\\\"(max-width: 700px) 100vw, 700px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>当然，虽然即时编译在运行过一次以后有了编译后的代码，再次运行时因为识别编译过的和未编译过的（即修改）代码，速度还是比静态编译的程序运行的慢。</p>\\n<p>避免二次编译也使得理论上即时编译的总体开销（编译和运行）优于静态编译和动态解释。</p>\\n<p>这里还出现了一个<strong>字节码</strong>的概念。</p>\\n<p>字节码的出现理由有点像<strong>交叉编译器</strong>（在 A 系统平台下可以产生 B 系统平台的可执行文件的编译器），在源码不能或很难编译成目标平台可执行文件时非常好用。感觉也有点像是跨平台的汇编语言，复杂度介于高级语言和低级语言之间。</p>\\n<p>在即时编译里出现的字节码是一种动态字节码转译方式，字节码也可以静态转译的，就是先编译成字节码再运行的。</p>\\n<p>字节码通常运行在一个程序<strong>虚拟机</strong>上。</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/6-f6aab7265b5859b112485bcf43d1fe00-0a76b.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 700px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 35.857142857142854%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAABFUlEQVQoz4VR2W6DMBDk/z+qUg+lL31pq7RVRAMIGkGwwfjiNNN1QhL1IelKI+85HnsD3LB5ngl0YsES/6mffIJzDoHVHJJHMIrDGgXBIlRFiNY26PoRWlWQVYKGJ7DWQEsGTnXBErRdByVLiHJLPRnGcUQgWIwsfALbR2AsRxo+Y/v5AFHtIJRBWSTIvleHfF0zsCJC9PWIXfwC0QiUeUjzKxTpG6aJCJ2boYy59XJSMqIbJvxn0zQR4exQC3GQ3/X9EYuvtEZT/SBLPpDFaxi5P//dVULv2LY9DGtSeoKxFryukaevCNf32LzfgeebM6FfgKE+S31ewDAMR8Jrt102efEdBX7Ikw20AKkUFEGTGE/s879n7B2MWs6vQQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #ffffff;\\\"\\n        alt=\\\"字节码与虚拟机\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/6-f6aab7265b5859b112485bcf43d1fe00-0a76b.png\\\"\\n        srcset=\\\"/static/6-f6aab7265b5859b112485bcf43d1fe00-56d76.png 197w,\\n/static/6-f6aab7265b5859b112485bcf43d1fe00-24e50.png 393w,\\n/static/6-f6aab7265b5859b112485bcf43d1fe00-0a76b.png 700w\\\"\\n        sizes=\\\"(max-width: 700px) 100vw, 700px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>图里的虚拟机部分也算是一个解释执行的过程。</p>\\n<p>广义的虚拟机包括一切跟任何真实机器无关的虚拟架构。\\n而当前虚拟机的实现主要分成三类：</p>\\n<ul>\\n<li>\\n<p><strong>系统虚拟机</strong>：虚拟了一个运行完整系统的操作平台。典型代表：VirtualBox。</p>\\n</li>\\n<li>\\n<p><strong>程序虚拟机</strong>：为单个计算机程序的运行虚拟必要的环境。典型代表：Java 虚拟机。</p>\\n</li>\\n<li>\\n<p><strong>操作系统层虚拟化</strong>：介于系统和单个程序之间，可以运行多个独立应用程序，但是又不用虚拟完整操作系统。典型代表：Docker。</p>\\n</li>\\n</ul>\\n<h1>Google V8</h1>\\n<p>终于来到了 Google V8！</p>\\n<blockquote>\\n<p><strong>V8</strong> 是 Google 开发的开源的 JavaScript 引擎，用于 Google Chrome 及 Chromium 中。</p>\\n</blockquote>\\n<blockquote>\\n<p><strong>JavaScript 引擎</strong>是一个专门处理 JavaScript 脚本的虚拟机，一般会附带在网页浏览器之中。</p>\\n</blockquote>\\n<p>V8 是用 C++ 写的，使用了即时编译技术，工作模式如下图：\\n\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/7-e725f6630e8fb14f65dfb9a6cd9a9a5b-0a76b.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 700px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 72.14285714285715%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAACWklEQVQ4y31TW2vUQBTef+L/UfBv+NBX/4KKKGLBBxGKb1pU6AqFrrW0aL3UYleqXXuhe3GvSZpNssnM5DbJ55kkm2yLeODkcs7MN9/5zpkaCjNMG87MRRxH8xCEEOj8XsXgfAthGuHg2xp2PrwHj2wgSXDj8W2s7W1na2UikaYpap7n4nvzEPdXv+DJiwZcxy4BHWuEg8Z17O0sZ//tbgsr9XVcWAbCKMTNO0tYXwBUVlOP3f1DLD2q497zDTo4T9BhmDkW2uctTKd2Fph6PpqnbTgeRxAEmPR68BwHUs73pDngUdfAw9VPePp2H9wPc3oEGEcxnQxEUZQHSs/lmJFErusV+QIwIS2Uff3Zxo/jXlnuSJug26/+HZejpTlwGUNSMHKEgUCKEqwsWRIocx1w0lMZD31s1zdQX3mJoT7OYvWtJq7d3cRyYxcRy9cZkxN400kJWJasPiTVVmpB/vndR2y92oTFdbBgAs1wsHv8B6YvMWM6TLuL4Ncp/KMTSFGxrM2pzk2Bpogx7Bk4aw1pkUQUxqRnCEFVWKZJoxVn69iFCabpSBY1LJHSSgfOJMIghIwlOBfggmVx3w+ycVEWU25q25knxb5LgGmaN0c3+3j2+has2RgitOGJMXVeh+WNiBUxJWnmjUzpnfn/AMdaB28aD9DqdaDRAJ+OBzgaKEAdzbM+9lr9crQWgS41pQKt9DzuXRBLAYv5MGZM3TSaN5KC9CoZFiCLVrsKppgq55yTM/iCZ+66LpjngdEcLjJTpgZb5dWw/5Ph1VOvWp6u2KmOq6uogP8CWxsq0aOLzukAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #ffffff;\\\"\\n        alt=\\\"V8 工作模式图-来自[1]\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/7-e725f6630e8fb14f65dfb9a6cd9a9a5b-0a76b.png\\\"\\n        srcset=\\\"/static/7-e725f6630e8fb14f65dfb9a6cd9a9a5b-56d76.png 197w,\\n/static/7-e725f6630e8fb14f65dfb9a6cd9a9a5b-24e50.png 393w,\\n/static/7-e725f6630e8fb14f65dfb9a6cd9a9a5b-0a76b.png 700w\\\"\\n        sizes=\\\"(max-width: 700px) 100vw, 700px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>感觉到这里已经足够说明什么是 Google V8 了，后面算是拓展阅读吧。</p>\\n<h3>V8 的隐藏类（Hidden Class）</h3>\\n<p>JavaScript 作为一种动态编程语言，对象上的属性（Property）可以随时增减。如果用字典类的数据结构来存储这些对象属性，访问的时候就会带来动态查找的损耗，这也是 JavaScript 比类似 Java 这种类型确定的语言慢的原因之一。</p>\\n<p>V8 用动态创建隐藏类的方式来减少这种损耗。</p>\\n<p>举个例子。</p>\\n<p>有如下简单的一段 JS 代码：</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-javascript\\\"><code class=\\\"language-javascript\\\"><span class=\\\"token keyword\\\">function</span> <span class=\\\"token function\\\">Point</span><span class=\\\"token punctuation\\\">(</span>x<span class=\\\"token punctuation\\\">,</span> y<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n  <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>x <span class=\\\"token operator\\\">=</span> x<span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">// E1</span>\\n  <span class=\\\"token keyword\\\">this</span><span class=\\\"token punctuation\\\">.</span>y <span class=\\\"token operator\\\">=</span> y<span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">// E2</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">Point</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token number\\\">1</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token number\\\">2</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span> <span class=\\\"token comment\\\">//  E0</span>\\n</code></pre>\\n      </div>\\n<p>语句按 E0、E1、E2 的顺序执行。</p>\\n<p>执行 E0 的时候，创建一个隐藏类 C0，对象的类指示器指向 C0。</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/8-dd1945631d2519b9b24166ffad948b41-42aa8.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 436px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 41.055045871559635%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABMElEQVQoz51S2W7CMBDk/78IiQdQKX1Ii6BIVAmhFAo57VwkIYlzTDeOgnrASy2N1/bujke7OwCtpmnwczXXt+++v3G/ssg/6IOEEIgjjiQO0ee1vlvI8wtEkaEsc2m7ey5zBu2WZyk8Y4HEfUZkKfCd7V0VVVWCHefYvY2hLkf43Exh7R7BzLUUIgl9R4e5ncD+eCLMYGwf4Psu0kuGJE0IqURMsGwLzkHBXp1Aex3hpE/h7GdwjivUPWHgaNBXQ6znQxl0UMcwjD2Y58PljMDp7MF2GdSNCp/bpLRAKTIUxYWQgbsm6rruCM8hQ2gqEMECufcCbizJebsBVVkgCjmpaYhQUB0FxVbyk9Zem9KSckuDZ79TkbM7TelqGAVckvYIA4b4HHRNae6Mw3/H5gsr+GioV5jVfgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #ffffff;\\\"\\n        alt=\\\"E0 阶段\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/8-dd1945631d2519b9b24166ffad948b41-42aa8.png\\\"\\n        srcset=\\\"/static/8-dd1945631d2519b9b24166ffad948b41-b9f8d.png 197w,\\n/static/8-dd1945631d2519b9b24166ffad948b41-e754c.png 393w,\\n/static/8-dd1945631d2519b9b24166ffad948b41-42aa8.png 436w\\\"\\n        sizes=\\\"(max-width: 436px) 100vw, 436px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>执行 E1 的时候，在 C0 基础上新建一个隐藏类 C1（C1 知道 x 属性存的位置），并给 C0 增加一个转换指示：如果增加一个 x 属性，就变成 C1。</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/9-3ba61291a82cff51302228ff51a15346-8b302.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 426px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 62.676056338028175%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAAB/ElEQVQ4y4WTaXPaMBCG+f8/pd+att+YSafTDBMoNw3hMBhblm8b4QMfmDeSTB3C0MnOrFeyvY/2UgtcqgrI8wzlqRJbnM/nxl6vawucqrO0wq/ia7mvv6KVHRM4ZApP78HRh4gOPupDqgb4rkDo6XCNKczdBLbwo3+5/wQstKVfS8BSt4diP0UeDOBoXZRlif9JYM1hrdvo/vqCl/4DyKINT32Ebys10N49Y9L9gT9PXzHofIO2+InNdgliWtANAzqlUg3TxHA2w2o5BvNV7L1amb+DY7zCd8glQn0AZj6DWX0crB5stYMoYryeJxRF8a486iRN4Ht1ap4fglIb7JDwjE5ge68GRsyHy+sXOwMERheBq12SO99N2Xcp9qHLwRZc28A+cODxd6F/qaF45FnGi+oiTWJ8JhWP/FQWiOMI/fGIN4pnwidENFEC/41DE4GjwtJGMLYjkO1QdlM0ztJn/OBj858ogajttQhWq5m3ywkeneFgPvEOfses9wDttY1A/42AdJDErHHOixwab9rtvLau6UKovoS66kPbjGGRFzh0AZfrat6FslnXXecgRVWhEfI50DIJd1SxWm+lDQIG1wuhKGsc0/jDv7fru0DH0kGNnQSvlnMo6wUMwvd0B3GrriO6vZZ3gSWvzTGNZDR5lkrNjrGE3QPcyhuQveJ7h0xKMwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #ffffff;\\\"\\n        alt=\\\"E1 阶段\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/9-3ba61291a82cff51302228ff51a15346-8b302.png\\\"\\n        srcset=\\\"/static/9-3ba61291a82cff51302228ff51a15346-7c7da.png 197w,\\n/static/9-3ba61291a82cff51302228ff51a15346-4c801.png 393w,\\n/static/9-3ba61291a82cff51302228ff51a15346-8b302.png 426w\\\"\\n        sizes=\\\"(max-width: 426px) 100vw, 426px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>执行 E2 的时候，在 C1 基础上新建一个隐藏类 C2（C2 知道 x 和 y 属性存位置），并给 C1 增加一个转换指示：如果增加一个 y 属性，就变成 C2。</p>\\n<p>\\n  <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/10-6e6628d1689c9913d336f32a4b5f7c72-ac902.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n  \\n  <span\\n    class=\\\"gatsby-resp-image-wrapper\\\"\\n    style=\\\"position: relative; display: block; ; max-width: 558px; margin-left: auto; margin-right: auto;\\\"\\n  >\\n    <span\\n      class=\\\"gatsby-resp-image-background-image\\\"\\n      style=\\\"padding-bottom: 79.39068100358423%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAACBklEQVQ4y41TaY+bMBDl//+efmgrVT2yUtW0Uo/d7bJJCae5A5gjAQfyOnY22YQuakZ68tjA482bsQaK/R7ouhZ93+Ow31+Fvh/UOgzPuSbJeGqiir6DR3cQ3QbXRL/rELs/YDzcwFvNETlfUZcJtO2Gg/35CFv/AEd/h8j7jXrTom5qQjOBDRhzEVpzmPoMvvmF8s/gGYPWbisEqxv4xiew5XuE3gOKskLOCwJ/QnFAUZzOme9BCKHIs6wgywSapoQm5Ve5jzK+BU8W5IW4qmTRbVEWa3iuDcc2wSmvyvxAqDwhY/dP+cl45ZVAFhuIfV2pz6IlitRWTRSELEvheg560ZHiTjbl8PE50TE/KgnIjuWv11j8fIPYmiF25vSjnXreUdlplp2Ua1NkJ0LRouQpurZBmoTYNBWKPEEQBspTFgQnQjU2Ux49E3ao6xItmV5VFc0cUFeccq7UbVuaX3l4TjhWdq5QemhbK5imiSSOybOc9sY/zTu+r40PxjHQ7QmYhShk0PV76qqFOPSw24kXrbpQ2FRrFGuPwFDmAcG/uDm2572o6jwuCNfBLVz9Le6/vVK3Zu3MUGS+Gp9h6BFSyeMpGJNeEAbMhLG4A3MN8DyCay9gkV8JdVGSxWk6OV4ThA7MlYHHR12t8gbI6f9fmZOEsqMK1MEdjYvMZanjzp/n4/gLm8TWw8yhSsIAAAAASUVORK5CYII='); background-size: cover; display: block;\\\"\\n    >\\n      <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        style=\\\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #ffffff;\\\"\\n        alt=\\\"E2 阶段\\\"\\n        title=\\\"\\\"\\n        src=\\\"/static/10-6e6628d1689c9913d336f32a4b5f7c72-ac902.png\\\"\\n        srcset=\\\"/static/10-6e6628d1689c9913d336f32a4b5f7c72-35a8d.png 197w,\\n/static/10-6e6628d1689c9913d336f32a4b5f7c72-01661.png 393w,\\n/static/10-6e6628d1689c9913d336f32a4b5f7c72-ac902.png 558w\\\"\\n        sizes=\\\"(max-width: 558px) 100vw, 558px\\\"\\n      />\\n    </span>\\n  </span>\\n  \\n  </a>\\n    </p>\\n<p>隐藏类的创建过程就是隐藏类树的创建过程，在之后遇到新建对象实例，就会先试图从已创建的树里找到对应的类，没找到的话才会新建对应的树节点。</p>\\n<p>这之后，每个对象的类指示器都指向对应的隐藏类，和 Java 里的类与对象关系差不多，JavaScript 在访问属性的时候就避免了相对漫长的查找，从而加快了速度。</p>\\n<p>从这里也可以得出一个优化代码的方式：尽量用相同的顺序实例化对象属性以最大化复用隐藏类树。</p>\\n<h3>GC（垃圾回收）</h3>\\n<p>V8 将内存分成：</p>\\n<ul>\\n<li><strong>new-space</strong>：对象刚创建的时候分配这里的内存给对象。内存小，GC 删除的一般是这里的数据。</li>\\n<li><strong>old-data-space</strong>：new-space 里的一些对象经过一轮 GC 没被删除，并且这些对象内部不包含指针（纯数据），就会被移到这里。</li>\\n<li><strong>old-pointer-space</strong>：new-space 里的一些对象经过一轮 GC 没被删除，并且这些对象内部包含指针（指向别的对象），就会被移到这里。</li>\\n<li><strong>large-object-space</strong>：大小超过别的 space 大小限制的对象会被放在这里，它们有专门非配的内存，不归 GC 管。</li>\\n<li><strong>code-space</strong>：代码对象（包含即时编译后的指令）存放的地方。会被执行的代码不是放在这里就是放在 large-object-space 里。</li>\\n<li><strong>cell-space，property-cell-space，map-space</strong>：分别存放对应名字（cells、propertyCells、maps）的地方（这里我也不太懂这啥）。</li>\\n</ul>\\n<p>GC 首先做的是分清数据对象和指针，因为跟踪指针才能知道哪些对象是不能被回收的。</p>\\n<p>V8 的 GC 有以下几个特点：</p>\\n<ul>\\n<li>运行 GC 的时候停止执行程序。</li>\\n<li>绝大多数的 GC 只处理部分数据对象内存垃圾以最小化对应用程序的影响。</li>\\n<li>总是正确地知道所有的对象和指针的存储位置。这避免了将对象误认为指针导致的内存泄漏。</li>\\n</ul>\\n<p>GC 我也没多看，也说不出个所以然来了，更多可以看<a href=\\\"http://www.jayconrod.com/posts/55/a-tour-of-v8-garbage-collection\\\">A tour of V8: Garbage Collection</a>。</p>\\n<p><strong>参考</strong>：</p>\\n<p><a href=\\\"https://medium.com/reloading/javascript-start-up-performance-69200f43b201\\\">图[1]来源</a></p>\\n<p>维基百科上的各种词条</p>\\n<p><a href=\\\"https://github.com/v8/v8/wiki/Design-Elements\\\">Design Elements</a></p>\\n<p><a href=\\\"http://www.jayconrod.com/posts/55/a-tour-of-v8-garbage-collection\\\">A tour of V8: Garbage Collection</a></p>\",\"fields\":{\"tagSlugs\":[\"/blog/tags/js/\"]},\"frontmatter\":{\"title\":\"什么是 Google V8\",\"tags\":[\"js\"],\"date\":\"2018-03-19\"}}},\"pathContext\":{\"slug\":\"/blog/2018-03-19-what-is-google-v-8\"}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/_json-loader@0.5.7@json-loader!./.cache/json/blog-2018-03-19-what-is-google-v-8.json\n// module id = 355\n// module chunks = 210764608676883"],"sourceRoot":""}